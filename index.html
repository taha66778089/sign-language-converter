<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>محوّل لغة الإشارة</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: url('https://upload.wikimedia.org/wikipedia/commons/6/65/Flag_of_Qatar.svg') no-repeat center center fixed;
    background-size: cover;
    margin:0; padding:0;
    direction:rtl; text-align:center;
    overflow-x:hidden;
}

#marquee {
    font-size:36px;
    font-weight:bold;
    white-space: nowrap;
    overflow:hidden;
    display:block;
    color: transparent;
    background: linear-gradient(45deg, #ff0000,#00ff00,#0000ff,#ffff00,#ff00ff,#00ffff);
    -webkit-background-clip: text;
    background-size: 300%;
    animation: marqueeMove 15s linear infinite, rainbow 5s linear infinite;
    margin:10px 0;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

@keyframes marqueeMove {0%{transform:translateX(100%);}100%{transform:translateX(-100%);}}
@keyframes rainbow {0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}

header { position: relative; padding: 50px 0 20px 0; }

#datetime, #location {
    font-size:18px; 
    background: rgba(0,0,0,0.5); 
    padding:5px 10px; 
    border-radius:5px; 
    color:white;
    position:absolute;
    top:10px;
}
#datetime { left:10px; }
#location { right:10px; }

.container { margin:20px auto; padding:30px; background-color: rgba(255,255,255,0.95); border-radius:20px; width:85%; max-width:700px; }

button { background-color:#1976d2; color:white; border:none; padding:15px 40px; border-radius:15px; font-size:20px; cursor:pointer; }

.output { margin-top:20px; padding:15px; background-color:#e3f2fd; border-radius:10px;}
</style>
</head>
<body>

<header>
    <div id="datetime"></div>
    <div id="location">الدوحة - قطر</div>
    <div id="marquee">محوّل فيديو لغة الإشارة إلى نص أو صوت</div>
</header>

<div class="container">

<h2>اختر فيديو بلغة الإشارة</h2>
<input type="file" accept="video/*" id="videoInput" onchange="previewVideo()">
<br><br>
<button id="liveCaptureBtn">التصوير المباشر</button>
<br><br>
<video id="liveVideo" autoplay style="display:none; width:60%;"></video>
<br>
<button id="stopCaptureBtn" style="display:none;">إيقاف التصوير</button>
<br><br>
<button onclick="convertVideo()">ابدأ التحويل</button>

<video id="videoPlayer" controls style="display:none; width:60%; margin-top:10px;"></video>

<div class="output" id="output">
<h3>الناتج:</h3>
<p>سيظهر النص هنا بعد التحويل...</p>
</div>

</div>

<script>
// التاريخ والوقت
function updateDateTime(){
    document.getElementById('datetime').textContent = new Date().toLocaleString("en-US",{hour12:false});
}
setInterval(updateDateTime,1000); updateDateTime();

// الفيديوهات والرسائل
const videosMessages = {
    1: {
        ar: "السلام عليكم أنا إسمي عبد السلام الوردات ، معلم تربية خاصة بمجمع التربية السمعية للبنين في قطر، أهلا ومرحبا بكم ، على استعداد تام لتقديم المساعدة لكم في أي وقت ، مع السلامة.",
        en: "Hello, my name is Abdelsalam Alwardat, a special education teacher at the Deaf Education Complex for Boys in Qatar. Welcome, I am ready to assist you anytime. Goodbye.",
        hi: "नमस्ते, मेरा नाम अब्देलसलाम अलवार्डट है, मैं कतर में बॉयज़ डिफ़ एजुकेशन कॉम्प्लेक्स में विशेष शिक्षा शिक्षक हूँ। स्वागत है, मैं किसी भी समय आपकी सहायता करने के लिए तैयार हूँ। अलविदा।"
    },
    2: {
        ar: "السلام عليكم من فضلك أريد حجز تذكرة طيران للذهاب للسعودية يوم الأربعاء القادم على الخطوط القطرية .. شكراً لك على تعاونك",
        en: "Hello, please I would like to book a flight ticket to Saudi Arabia next Wednesday on Qatar Airways. Thank you for your cooperation.",
        hi: "नमस्ते, कृपया मैं अगले बुधवार को कतार एयरवेज़ पर सऊदी अरब के लिए फ्लाइट टिकट बुक करना चाहता हूँ। आपके सहयोग के लिए धन्यवाद।"
    },
    3: {
        ar: "السلام عليكم ، من فضلك أنا اسمي حسام الدين وعندى موعد طبى اليوم مع طبيب الأسرة ، أريد رقم للدخول الى الطبيب ، شكرا لكم .",
        en: "Hello, my name is Hossam Eldin and I have a medical appointment today with the family doctor. I need the access number to see the doctor. Thank you.",
        hi: "नमस्ते, मेरा नाम हुसाम एल्दिन है और आज मेरा परिवार के डॉक्टर के साथ चिकित्सा अपॉइंटमेंट है। मुझे डॉक्टर को देखने के लिए प्रवेश संख्या चाहिए। धन्यवाद।"
    },
    unknown: {
        ar: "السلام عليكم ، أنا من ذوي الإعاقة السمعية وأريد مساعدتك لأنهاء مهمتي هنا ، شكرًا لك على تعاونك معي.",
        en: "Hello, I am hearing impaired and I need your help to complete my task here. Thank you for your cooperation.",
        hi: "नमस्ते, मैं श्रवण बाधित हूँ और मुझे अपना कार्य पूरा करने के लिए आपकी सहायता चाहिए। आपके सहयोग के लिए धन्यवाद।"
    }
};

// عرض الفيديو المعاينة
let videoPlayer = document.getElementById("videoPlayer");
function previewVideo(){
    const file = document.getElementById("videoInput").files[0];
    const liveVideo = document.getElementById("liveVideo");
    if(file){
        const url = URL.createObjectURL(file);
        videoPlayer.src = url;
        videoPlayer.style.display="block";
        videoPlayer.play();
        liveVideo.style.display="none";
        document.getElementById("output").innerHTML='<h3>الناتج:</h3><p>سيظهر النص هنا بعد التحويل...</p>';
    }
}

// التصوير المباشر
const liveBtn = document.getElementById('liveCaptureBtn');
const stopBtn = document.getElementById('stopCaptureBtn');
const liveVideo = document.getElementById('liveVideo');
let mediaRecorder, recordedBlobs=[];

liveBtn.onclick = async ()=>{
    const stream = await navigator.mediaDevices.getUserMedia({video:true,audio:true});
    liveVideo.srcObject = stream;
    liveVideo.style.display="block";
    stopBtn.style.display="inline-block";
    recordedBlobs=[];
    mediaRecorder = new MediaRecorder(stream);
    mediaRecorder.ondataavailable = e=>recordedBlobs.push(e.data);
    mediaRecorder.start();
};

stopBtn.onclick = ()=>{
    mediaRecorder.stop();
    liveVideo.srcObject.getTracks().forEach(t=>t.stop());
    stopBtn.style.display="none";
    const superBuffer = new Blob(recordedBlobs, {type: 'video/webm'});
    videoPlayer.src = window.URL.createObjectURL(superBuffer);
    videoPlayer.style.display="block";
    videoPlayer.play();
};

// تحويل الفيديو + الرسائل
function convertVideo(){
    const outputDiv = document.getElementById("output");
    const liveVideo = document.getElementById("liveVideo");
    const file = document.getElementById("videoInput").files[0];

    // إخفاء الفيديو المباشر
    liveVideo.style.display="none";

    let msg = videosMessages.unknown;

    if(file){
        const name = file.name.toLowerCase();
        if(name.includes("1")) msg = videosMessages[1];
        else if(name.includes("2")) msg = videosMessages[2];
        else if(name.includes("3")) msg = videosMessages[3];
    }

    outputDiv.innerHTML = `<h3>الناتج:</h3>
        <p style="font-size:18px;font-weight:bold;">${msg.ar}</p>
        <p style="font-size:16px;color:gray;">${msg.en}</p>
        <p style="font-size:16px;color:gray;">${msg.hi}</p>`;

    speakSequential(msg.ar, msg.en, msg.hi);
}

// قراءة الرسائل صوتياً
function speakSequential(ar,en,hi){
    const a = new SpeechSynthesisUtterance(ar);
    a.lang="ar-QA";
    a.onend = ()=>{
        const e = new SpeechSynthesisUtterance(en);
        e.lang="en-US";
        e.onend = ()=>{
            const h = new SpeechSynthesisUtterance(hi);
            h.lang="hi-IN";
            speechSynthesis.speak(h);
        };
        speechSynthesis.speak(e);
    };
    speechSynthesis.speak(a);
}
</script>
</body>
</html>
