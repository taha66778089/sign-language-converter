<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>محوّل لغة الإشارة</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: url('https://upload.wikimedia.org/wikipedia/commons/6/65/Flag_of_Qatar.svg') no-repeat center center fixed;
    background-size: cover;
    margin:0; padding:0;
    direction:rtl; text-align:center;
    overflow-x:hidden;
}

/* نفس التنسيقات كما هي */
#marquee {
    font-size:36px;
    font-weight:bold;
    white-space: nowrap;
    overflow:hidden;
    display:block;
    color: transparent;
    background: linear-gradient(45deg, #ff0000,#00ff00,#0000ff,#ffff00,#ff00ff,#00ffff);
    -webkit-background-clip: text;
    background-size: 300%;
    animation: marqueeMove 15s linear infinite, rainbow 5s linear infinite;
    margin:10px 0;
}
@keyframes marqueeMove {0%{transform:translateX(100%);}100%{transform:translateX(-100%);}}
@keyframes rainbow {0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}

header { position: relative; padding: 50px 0 20px 0; }

#datetime, #location {
    font-size:18px; 
    background: rgba(0,0,0,0.5); 
    padding:5px 10px; 
    border-radius:5px; 
    color:white;
    position:absolute;
    top:10px;
}
#datetime { left:10px; }
#location { right:10px; }

.container { margin:20px auto; padding:30px; background-color: rgba(255,255,255,0.95); border-radius:20px; width:85%; max-width:700px; }

button { background-color:#1976d2; color:white; border:none; padding:15px 40px; border-radius:15px; font-size:20px; cursor:pointer; }

.output { margin-top:20px; padding:15px; background-color:#e3f2fd; border-radius:10px;}
</style>
</head>

<body>

<header>
    <div id="datetime"></div>
    <div id="location">الدوحة - قطر</div>
    <div id="marquee">محوّل فيديو لغة الإشارة إلى نص أو صوت</div>
</header>

<div class="container">

<button id="liveCaptureBtn">التصوير المباشر</button>
<br><br>
<video id="liveVideo" autoplay style="display:none; width:60%;"></video>
<br>
<button id="stopCaptureBtn" style="display:none;">إيقاف التصوير</button>

<br><br>
<button onclick="convertVideo()">ابدأ التحويل</button>

<div class="output" id="output">
<h3>الناتج:</h3>
<p>سيظهر النص هنا بعد التحويل...</p>
</div>

</div>

<script>
let liveVideo = document.getElementById("liveVideo");
let liveBtn = document.getElementById("liveCaptureBtn");
let stopBtn = document.getElementById("stopCaptureBtn");
let mediaRecorder, recordedBlobs=[];

liveBtn.onclick = async ()=>{
    const stream = await navigator.mediaDevices.getUserMedia({video:true,audio:true});
    liveVideo.srcObject = stream;
    liveVideo.style.display="block";
    stopBtn.style.display="inline-block";
    recordedBlobs=[];
    mediaRecorder = new MediaRecorder(stream);
    mediaRecorder.ondataavailable = e=>recordedBlobs.push(e.data);
    mediaRecorder.start();
};

stopBtn.onclick = ()=>{
    mediaRecorder.stop();
    liveVideo.srcObject.getTracks().forEach(t=>t.stop());
    stopBtn.style.display="none";
};

// ===== الرسالة المطلوبة =====
const msgAr = "السلام عليكم ، من فضلك أنا من ذوي الإعاقة السمعية وأريد مساعدتك لأنهاء مهمتي هنا ، شكراً لك لتعاونك معي";
const msgEn = "Hello, I am hearing impaired and I need your help to complete my task here. Thank you for your cooperation.";
const msgHi = "नमस्ते, मैं श्रवण बाधित हूँ और मुझे अपना कार्य पूरा करने के लिए आपकी सहायता चाहिए। आपके सहयोग के लिए धन्यवाद।";

function convertVideo(){
    // إخفاء فيديو التصوير المباشر
    liveVideo.style.display="none";

    const output = document.getElementById("output");
    output.innerHTML = `
    <h3>الناتج:</h3>
    <p><b>${msgAr}</b></p>
    <p>${msgEn}</p>
    <p>${msgHi}</p>
    `;

    speakSequential(msgAr, msgEn, msgHi);
}

function speakSequential(ar,en,hi){
    const a = new SpeechSynthesisUtterance(ar);
    a.lang="ar-SA";
    a.onend=()=>{
        const e = new SpeechSynthesisUtterance(en);
        e.lang="en-US";
        e.onend=()=>{
            const h = new SpeechSynthesisUtterance(hi);
            h.lang="hi-IN";
            speechSynthesis.speak(h);
        };
        speechSynthesis.speak(e);
    };
    speechSynthesis.speak(a);
}

// الوقت
function updateDateTime(){
    document.getElementById('datetime').textContent=new Date().toLocaleString("en-US",{hour12:false});
}
setInterval(updateDateTime,1000); updateDateTime();
</script>

</body>
</html>
